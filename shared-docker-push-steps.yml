# Steps to push a Docker container to a Docker repository.

parameters:
- name: imageRepository # Name of the repository.
- name: dockerRegistryServiceConnection # A Docker registry service connection.
- name: tag # A list of tags in separate lines. e.g. beta1.1, latest

steps:
# Login to the Docker registry
- task: Docker@2
  displayName: Docker Login
  inputs:
    containerRegistry: '${{ parameters.dockerRegistryServiceConnection }}'
    command: 'login'

# Push the docker container to the registy
- task: Docker@2
  displayName: Docker Push
  inputs:
    containerRegistry: '${{ parameters.dockerRegistryServiceConnection }}'
    repository: '${{ parameters.imageRepository }}'
    command: 'push'
    tags: |
      ${{ parameters.tag }}
      latest
      
# Logout of the Docker registry
- task: Docker@2
  displayName: Docker Logout
  inputs:
    containerRegistry: '${{ parameters.dockerRegistryServiceConnection }}'
    command: 'logout'